# 变量的存储类型

#### 1. 局部变量的存储类型

1. 自动变量

   局部变量定义时不指明存储类型或用auto说明时，都是自动变量。自动变量分配在动态存储区。程序执行到该局部变量所在域时，C系统为该局部变量分配存储空间，执行完该域后，释放其所在的空间。再次调用函数时，系统将为自动变量重新分配空间。如果自动变量定义时有初值，每调用一次函数，都要赋初值。没有赋初值的自动变量，将得到分配给它的内存单元原有的值，是一个不确定的值

2. 静态局部变量

   使用 static定义的局部变量，称为静态局部变量。它的作用域与自动变量一样，但它被分配在静态存储区中，因此，当函数调用完成后，它依然存在，再次调用函数时，C系统不再重新为静态局部变量分配存储空间，赋给静态局部变量的初值是在编译时完成的，程序执行期间不再赋初值，因此局部静态变量可以保存上一次函数结束时的值，以备下一次函数调用时使用。对定义时未赋初值的静态局部变量，C系统在编译时自动赋初值一次，数值型赋0，字符型赋空格

3. 寄存器变量

   使用 register定义的局部变量，称为寄存器变量。寄存器变量占用CPU的通用寄存器，而不占内存单元，因此使用寄存器变量就省去了访问内存的时间，从而提高了程序的执行速度。也由于这一特点，使用时请注意:

   1. 寄存器非常有限，不可能让变量长时间占有，所以寄存器变量只可能是自动变量，且程序中使用的寄存器变量的数目也是有限的
   2. 由于长度的限制，有的系统只允许将char、int和指针型变量定义为寄存器变量
   3. 寄存器变量没有地址，不能对它进行求地址运算
   4. 那些被频繁使用、占用字节数又不多的变量，适合定义为寄存器变量。当今的优化编译系统能够识别频繁使用的变量，能自动地将这些变量放在寄存器中，而不需要程序设计者指定。因此，不必用 register声明变量

#### 2. 全局变量的存储类型

1. 外部变量

   没有用static定义的全局变量就是外部变量，引用这种外部变量时，用extern加以说明，就可以使它的作用范围扩大到它所在的整个源程序文件，甚至其他文件

   使用外部变量时应注意以下问题：

   1. 在同一个源程序文件中使用外部变量时，如果使用在前，定义在后，必须用 extern进行引用性声明
   2. 使用另一个源程序文件中定义的外部变量，必须用 extern声明后，才能使用
   3. 当全局变量和局部变量名相同时，在局部变量的作用范围内，局部变量起作用，全局变量被屏蔽

   extern有两种声明形式，定义性声明和引用性声明。定义性声明是为了建立实体，即建立变量的存储空间。引用性声明是为了建立标识符与实体之间的联系

   定义性声明的形式为：
   `[extern]类型 变量名[＝初始化表达式];`

   定义在函数体外的变量都是外部变量，所以 extern通常被缺省，初始化表达式被缺省时，C系统为数值型外部变量赋0，字符型赋空格

   引用性声明的形式为：

   `extern 类型 变量名;`

   定义性声明和引用性声明的区别如下:

   1. 定义性声明一定是在外部，引用性声明不限于外部，只要在使用该外部变量前声明即可

   2. 定义性声明可以初始化，引用性声明不能初始化

   3. 定义性声明在程序中只有一次，而引用性声明可以有多次

2. 静态全局变量

   当用 static定义全局变量时，该全局变量不允许其他文件引用，只能在定义它的源文件中使用，这种变量称为静态全局变量

   C语言中的函数与全局变量类似，无论定义时是否用 extern修饰，都是外部的，都具有静态生存期，若要使用在一个程序中的其他文件定义的函数，用 extern进行引用性声明

   如果函数不允许其他文件引用，定义时在函数名前面加 static修饰

全局变量的两种存储类型中 extern（外部的比较简单，它只能用于全局变量，主要说明该变量是定义在其他文件中或定义在本文件中（但调用在前）的外部变量（全局变量）；在定义全局变量时，extern可以加在变量前，也可以不加，而static既可以加在局部变量前，也可以加在全局变量前， static具有永久和私有两种属性，局部变量本身具有私有性（只能在本函数使用），用 static定义后，使其又具有永久性（不释放），而全局变量本身具有永久性（程序运行期间始终存在），用static定义后，使其又具有私有性（其他文件不能引用）